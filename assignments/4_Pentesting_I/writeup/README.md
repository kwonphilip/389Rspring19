# Writeup 3 - Operational Security and Social Engineering

Name: Philip Kwon
Section: 0101

I pledge on my honor that I have not given or received any unauthorized assistance on this assignment or examniation.

Digital acknowledgement: Philip Kwon

## Assignment Writeup

### Part 1 (40 pts)

Flag - CMSC389R-{d1gging_f0r_flag5_thr0ugh_1njec7ion}

Input - ";cd home;cat flag.txt"

I connected to the server and I was asked to input an IP or domain to look up. I decided to see if I could look up the files on the server by using a semi-colon to inject commands.

I injected a command by typing in ";ls". This gave me a list of all the files on the server. Now that I knew that the semi-colon would work to inject commands, I wanted to use this to browse around the server for the flag. Unfortunately, I did not know how to input more than one command at a time. The server disconnected after every input I entered. After trying some random inputs to see if the server would respond differently, I realized that I could simply add another semi-colon. The first semi-colon allowed me to inject the extra command "ls". Therefore, I reasoned that I could use another semi-colon to add another input at the end of another input. I tested this by chaining several navigational inputs together to see if they would work (e.g. ";ls;cd bin;ls;cd ..;cd lib;ls;cd ..;ls"). The test confirmed that I could chain together as many inputs as needed, so long as they were each separated by a semi-colon.

I decided to check the "home" folder first by injecting the command ";cd home;ls". I ended up getting lucky on my first try because the "home" folder had the file "flag.txt". However, I still needed to confirm that the file had the flag I was after. Therefore, I reconnected to the server and used the input ";cd home;cat flag.txt". The flag that was output confirmed that I had found the correct file.

This vulnerability could be prevented by input validation and sanitization. Input validation is checking user input to ensure that the data requested of the user matches what the user has submitted. The user is free to input anything. However, when processing the input, validation code checks each field for its proper data type. If it's not the proper data type, the input is discarded. Input sanitization changes harmful user input so that it is benign. Input sanitization takes user input and "escapes" harmful portions of the input so that it is no longer harmful.

### Part 2 (60 pts)

The command to run the interactive shell is:

	python2 stub.py

The 1337bank.money server shuts down after every input. Therefore, one purpose of the interactive shell was to make it easier to navigate through the server without having to reconnect and re-input folder paths manually every time. Another purpose of the shell was to automatically inject commands so that the user can navigate the server without any extra effort.

The interactive shell program has three main variables: cmd, cmds, and path. The "cmd" variable stores the current user input. The "cmds" variable stores all past commands that are necessary such that the user does not have to re-type old commands. The "path" variable stores all navigation commands so that the user does not have to re-navigate to the same folder each time.

The shell makes navigating the server easier by automatically reconnecting to the server after each user input command. This way, using the shell feels similar to navigating in your own file system in a linux terminal. Furthermore, the shell prevents any unwanted input by using the echo functionality. The "cmds" variable always starts with ';echo "Hello"'. This means that the server will always return "Hello" in it's output. The shell then delimits the output at "Hello" and outputs only the data received after "Hello". The result is a clean interactive shell that cuts out a lot of annoying repetition.


